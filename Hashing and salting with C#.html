<h1>Hashing and Salting in C#</h1>

<h2>What is Hashing? What is Salting?</h2>
<p style="margin-bottom: 1px;">
    Hashing, in general, is a method of computing a unique value for a given piece of data. 
    Hashing is often used to convert a string of characters into a number. In cryptography, 
    hashing is used to encrypt data, like a password, so that it cannot be decrypted. Instead, 
    when a user enters a password, it is hashed and compared with the password hash stored in the database. 
    If the hashes match, the user can log in.
</p>
<p style="margin-bottom: 1px;">
    Salting is a way to add a random string to the end of a password before the password is hashed. 
    Not only does this make it harder to guess the password if attackers gain access to the hash, but 
    because each salt is different multiple users can have the same password while each resulting 
    hash is unique. 
</p>
<p>
    Next, we'll look at two algorithm for generating secure hashes.
</p>

<h2>PBKDF2 in C#</h2>
<p>
    PBKDF2 is a key derivation function recommended by 
    <a href="https://docs.microsoft.com/en-us/aspnet/core/security/data-protection/consumer-apis/password-hashing" 
    target="_blank">the Microsoft C# docs</a>. It works by 
    iterating a hash function (like SHA-512) over a password and a salt. The iteration count is the number of times 
    the hash function is applied to the password and salt. Here is an example of how to use PBKDF2 in C#:
</p>
<code>using Microsoft.AspNetCore.Cryptography.KeyDerivation;
using System.Security.Cryptography;

string password = "password123";
// Create a cryptographically strong salt
byte[] salt = new byte[16];
using (RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider())
{
    rng.GetBytes(salt);
}

// Create a 256-bit password hash
byte[] hash = KeyDerivation.Pbkdf2(
        password: password,
        salt: salt,
        prf: KeyDerivationPrf.HMACSHA512,
        iterationCount: 100000,
        numBytesRequested: 32);
</code>
<p>
    After creating the salt with the RNGCryptoServiceProvider, a cryptographic random number generator, 
    The password is hashed using HMACSHA512, which is a hash function that is designed to be computationally 
    secure. Since computers get faster every year, it is recommended to regularly increase the iteration 
    count in your code. When a user enters a password attempt, 
    the function is called again with the same salt, iterations, and requested bytes. If the new 
    key is the same as the one generated by the first call, the password is correct.
</p>

<h2>Argon2 in C#</h2>
<p>
    Argon2 is a more recent password hashing algorithm, and was the winner of the Password Hashing 
    Competition (PHC) in 2015. It accounts for parallelism, memory usage, and other factors that make 
    it more effective than other algorithms. Argon2 comes in three versions: Argon2d, Argon2i, and 
    Argon2id, which uses the previous two together. Here is an example of how to use Argon2 in C# 
    to create a hash:
</p>
<code>using Konscious.Security.Cryptography;
using System.Security.Cryptography;
using System.Text;

string password = "password123";

// Create a cryptographically strong salt
byte[] salt = new byte[32];
using (RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider())
{
    rng.GetBytes(salt);
}

byte[] hash = new byte[32];
using (var argon2id = new Argon2id(Encoding.UTF8.GetBytes(password)))
{
    argon2id.Salt = salt;
    argon2id.Iterations = 10;
    argon2id.MemorySize = 65536; // 2^16KiB = 64MiB
    argon2id.DegreeOfParallelism = 8;

    hash = argon2id.GetBytes(32);
}
</code>
<p>
    Argon2's extra security measures mean that the iteration count doesn't need to be a massive number 
    that grows even bigger on a regular basis.
</p>

<p style="margin-top: 1rem; font-size: 1.0625rem;">
    In this article you've learned what hashing and salting are and how to perform these operations 
    on passwords in C#. For more information on hashing and salting in C#, please see the documentation on 
    <a href="https://docs.microsoft.com/en-us/aspnet/core/security/data-protection/consumer-apis/password-hashing" 
    target="_blank">hashing and salting with PBKDF2</a> and the 
    <a href="https://github.com/kmaragon/Konscious.Security.Cryptography">
        Konscious.Security.Cryptography library</a>. 
</p>

<!-- Tags: C#,Cyber security -->
